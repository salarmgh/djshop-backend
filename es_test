from django.core.files.uploadedfile import SimpleUploadedFile
from backend.es_models import VariantIndex
from backend.models import *
from backend.tests.helpers import generate_random_string, generate_random_number
attribute =Attribute.objects.create(name=generate_random_string(5, 5))
attribute_value = AttributeValue.objects.create(value=generate_random_string(5, 5), attribute=attribute)
image_file = SimpleUploadedFile(name="test.jpg", content=open('backend/tests/assets/placeholder.jpg', 'rb').read(), content_type='image/jpeg')
image = Image.objects.create(title=generate_random_string(5, 5), image=image_file)
product = Product.objects.create(title=generate_random_string(5, 5), slug=generate_random_string(5, 5), featured=True, image=image)
from backend.serializers import *
variant = Variant.objects.create(name=generate_random_string(5, 5), product=product, price=generate_random_number(5, 5))
variant.attributes.set([attribute])
variant.save()

serialized_product = ESProductSerializer(product).data
serialized_attribute = AttributeSerializer(instance=attribute).data
index = VariantIndex(meta={'id': 14}, product=serialized_product, name=variant.name, price=variant.price, body='')

